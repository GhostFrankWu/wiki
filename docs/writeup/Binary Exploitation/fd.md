# fd

Category: Binary Exploitation

Source: pwnable.kr

Author: unknown

Score: 5

## Description

Mommy! what is a file descriptor in Linux?

* try to play the wargame your self but if you are ABSOLUTE beginner, follow this tutorial link:
https://youtu.be/971eZhMHQQw

ssh fd@pwnable.kr -p2222 (pw:guest)

## Exploitation

We see that there is a message where a kid asks him mom about file descriptor in Linux, pretty clear what fd stands for now here

Also it has a command to connect to the challenge through SSH , so we connect through SSH

![img](https://miro.medium.com/max/60/1*cSQ521zvqOqi5Dk7w-wjfw.png?q=20)

![img](https://miro.medium.com/max/700/1*cSQ521zvqOqi5Dk7w-wjfw.png)

We got connected successfully using the creds given from the challenge page , so we can see its a linux box , checking the contents of the home directory of fd user

![img](https://miro.medium.com/max/60/1*s2ky8AChlmze4nmK9vQ8dw.png?q=20)

![img](https://miro.medium.com/max/621/1*s2ky8AChlmze4nmK9vQ8dw.png)

We can see three interesting file ***fd\*** , ***fd.c\*** and ***flag\*** which is having the flag to the challenge. The fd is an ELF binary and ***fd.c\*** is the C code on which the binary was created.

So we move onto checking the C code

![img](https://miro.medium.com/max/60/1*_lY_hHz_c_wjfSeLA0FslQ.png?q=20)

![img](https://miro.medium.com/max/536/1*_lY_hHz_c_wjfSeLA0FslQ.png)

We see that it first checked whether the user inputs two arguments including the filename at the beginning , if it doesn't then we get the message of passing an argument with the binary.

Also we see that the variable ***buf\*** is assigned 32 characters as buffer

Then we see it has a variable ***fd\*** which is assigned the value of

> atoi( argv[1] ) — 0x1234

***atoi()\*** function converts ascii or string to integer

And one more variable ***len\*** which has value **0**

After that we see that ***len\*** value’s changing to

> read(fd, buf, 32)

Which puts the value of ***fd\*** into the ***buf\***

Then there is a string compare function(***strcmp\***) checking whether the string is not equal to “***LETMEWIN\n\***” then it returns the message about learning Linux file I/O

So what is this all about?? First let me tell you in short about file descriptors

In Linux machine and C language , the Linux Descriptors have a value **0** for **STDIN(Standard Input)** *,* **1** for **STDOUT(Standard Output)**, **2** for **STDERR(Standard Error)**

So if we look on man page of read()

![img](https://miro.medium.com/max/2000/1*Yap7NUQRYfJwPiiONOotfA.png)

So we see that all it does is read from a file descriptor , so here if we can put **0** into **fd** , then we will be able to give an input to the program.

First we try running the binary program

![img](https://miro.medium.com/max/448/1*OV0fKG8Ffaj-yJSRU_iPUA.png)

We see without giving an argument , we get a message for passing an argument , so I just put a random number as an argument and see

![img](https://miro.medium.com/max/60/1*vuzk4o_JMhh7TgHzdGEYVg.png?q=20)

![img](https://miro.medium.com/max/314/1*vuzk4o_JMhh7TgHzdGEYVg.png)

We get a message about learning linux file IO , so from the C code , we can see that all we had to do something is put a number which will get subtracted to ***0x1234\*** and make it a result of ***Zero.\*** So we use python for this as its not that complicated

![img](https://miro.medium.com/max/60/1*741Ho9Nb_qeh2U7maaNUzw.png?q=20)

![img](https://miro.medium.com/max/700/1*741Ho9Nb_qeh2U7maaNUzw.png)

We see the integer value for ***0x1234\*** is ***4660\*** , so we now pass this as an argument and see

![img](https://miro.medium.com/max/60/1*fCQlk6T8hhYDUlXJ6dHurw.png?q=20)

![img](https://miro.medium.com/max/242/1*fCQlk6T8hhYDUlXJ6dHurw.png)

We can see that it got hung and most probably waiting for an input , so we now just pass the string which was there in the ***strcmp()\*** function and see if we can get the flag

![img](https://miro.medium.com/max/60/1*3FnjmT6S0nHUIujrpPMmqg.png?q=20)

![img](https://miro.medium.com/max/515/1*3FnjmT6S0nHUIujrpPMmqg.png)

We see that we get the message of good job followed by the flag , so we now copy and paste this on the challenge page to complete the challenge

![img](https://miro.medium.com/max/60/1*R95tMsbDFSrHgaVFnwqUlg.png?q=20)

![img](https://miro.medium.com/max/700/1*R95tMsbDFSrHgaVFnwqUlg.png)

So here we paste the flag and click on Auth

![img](https://miro.medium.com/max/60/1*na4uci8iYRVeTVHVKU880g.png?q=20)

![img](https://miro.medium.com/max/521/1*na4uci8iYRVeTVHVKU880g.png)

As I already pasted the flag before creating this writeup , so I got this message like above.

## Reference

File descriptor: https://en.wikipedia.org/wiki/File_descriptor

C library function - atoi(): https://www.tutorialspoint.com/c_standard_library/c_function_atoi.htm

read(3) - Linux man page: https://linux.die.net/man/3/read

Writeup from https://arkanoidctf.medium.com/pwnable-kr-writeup-fd-bf200047cfc2